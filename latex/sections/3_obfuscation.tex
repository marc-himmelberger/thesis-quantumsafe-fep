\chapter{Obfuscating NIST candidates}\label{ch:obfuscation}

In this section, we construct encodings for different post-quantum KEMs suitable for use in the \drivel protocol.

While such encodings have already been constructed for elliptic curve Diffieâ€“Hellman \cite{EC:vAhHop04,tor-dev-udh,USENIX:WWGH11,CCS:BHKL13,FC:Tibouchi14} as well as for ML-KEM \cite{CCS:GunSteVei24}, other KEMs are also being examined for future use.

We take a selection of Round 4 candidates of the NIST Post-Quantum Cryptography Standardization \cite{nist-standardization}, as well as previous candidate schemes which we believe to be of interest.
For each scheme, we describe the generation of public keys and ciphertexts in the original scheme and examine their distributions. We then introduce (if needed) compatible KEM encodings mapping ciphertexts to bitstrings. Finally, we give concrete bounds for the first-encaps success probabilities and ciphertext uniformity of our constructions, which, together with the KEM's security properties, allows the corresponding instantiation of $\drivel$ to achieve $\sObfKe$ security.

\cref{tab:obfuscation-summary} summarizes the results of the later sections.

\begin{table}
    \centering
    \footnotesize\raggedright
    \begin{tabular}{@{} L{0.2\textwidth-\tabcolsep} | L{0.32\textwidth-2\tabcolsep} L{0.2\textwidth-2\tabcolsep} L{0.28\textwidth-\tabcolsep} @{}}
        \textbf{KEM /\newline Encoding} & \textbf{Ciphertext uniformity} & \textbf{First-encaps Success Probability}\newline (\cref{def:first-encaps-success}) & \textbf{Output Size}\newline (in bytes)\\ \hline
               
        Classic McEliece \cite{NISTPQC-R4:ClassicMcEliece22} \newline/ None
        & $\leq 2 \cdot \left( \advantage{\prkey}{}[] + \advantage{\mdsd}{}[] \right)$\newline (cf. \cref{lem:classic-mceliece-ctxt-unif})
        & 1
        & 96 (\textsf{mceliece348864}, +0)\newline
          156 (\textsf{mceliece460896}, +0)\newline
          208 (\textsf{mceliece6688128}, +0)\newline
          194 (\textsf{mceliece6960119}, +0)\newline
          208 (\textsf{mceliece8192128}, +0)\newline \\
    \end{tabular}
    \caption[
        Summary of KEMs, their corresponding encodings and the results of our analysis.
    ]{
        Summary of KEMs, their corresponding encodings and the results of our analysis. The origins of analysis results are specified, and for output sizes, differences in bytes from original public key/ciphertext sizes are given. This table can be viewed as an extension of \cite[Table~2]{CCS:GunSteVei24}.}
    \label{tab:obfuscation-summary}
\end{table}
