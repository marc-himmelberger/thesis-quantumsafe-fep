\chapter{Obfuscating NIST candidates}\label{ch:obfuscation}

In this section, we construct encodings for different post-quantum KEMs suitable for use in the \pqobfs protocol.

While such encodings have already been constructed for elliptic curve Diffieâ€“Hellman \cite{CCS:BHKL13, tor-dev-udh, USENIX:WWGH11} as well as for ML-KEM \cite{CCS:GunSteVei24}, other KEMs are also being examined for future use.

We take a selection of round 4 candidates of the NIST Post-Quantum Cryptography Standardization, as well as previous candidate schemes which we believe to be of interest.
For each scheme, we describe the generation of public keys and ciphertexts in the original scheme and examine their distributions. We then introduce encoding algorithms from the original public keys and ciphertexts to bitstrings and finally give concrete bounds for uniformity and encoding success rate.

We call all our encoding schemes TODO where TODO is the name of the corresponding KEM. \cref{tab:obfuscation-summary} summarizes the result of the later sections.

\begin{table}
    \centering
    \tiny\raggedright
    \begin{tabular}{@{} L{0.2\textwidth-\tabcolsep} | L{0.35\textwidth-2\tabcolsep} L{0.2\textwidth-2\tabcolsep} L{0.25\textwidth-\tabcolsep} @{}}
        \textbf{KEM /\newline Encoding} & \textbf{Obfuscation/Ciphertext uniformity} & \textbf{First-Keygen/Encap Success Probability}\newline (\cref{def:first-keygen-success,def:first-encap-success}) & \textbf{Output Size}\newline (in bytes)\\ \hline
        Classic McEliece \cite{NISTPQC-R4:ClassicMcEliece22} /\newline None & \rule{0pt}{1.2em} &  & \\
        - public keys & $\leq \advantage{\prkey}{}[]$\newline (cf. \cref{lem:classic-mceliece-pk-unif})
         & 1
         & 261 120 (\textsf{mceliece348864}, +0)\newline
         524 160 (\textsf{mceliece460896}, +0)\newline
         1 044 992 (\textsf{mceliece6688128}, +0)\newline
         1 047 319 (\textsf{mceliece6960119}, +0)\newline
         1 357 824 (\textsf{mceliece8192128}, +0)\newline \\
        - ciphertexts & $\leq 2 \cdot \left( \advantage{\prkey}{}[] + \advantage{\mdsd}{}[] \right)$\newline (cf. \cref{lem:classic-mceliece-ctxt-unif})
         & 1
         & 96 (\textsf{mceliece348864}, +0)\newline
         156 (\textsf{mceliece460896}, +0)\newline
         208 (\textsf{mceliece6688128}, +0)\newline
         194 (\textsf{mceliece6960119}, +0)\newline
         208 (\textsf{mceliece8192128}, +0)\newline \\
    \end{tabular}
    \caption{Summary of KEMs, their corresponding encodings and the results of our analysis. The origins of analysis results are specified, and for output sizes, differences in bytes from original public key/ciphertext sizes are given. This table can be viewed as an extension of \cite[Table~2]{CCS:GunSteVei24}.}
    \label{tab:obfuscation-summary}
\end{table}
